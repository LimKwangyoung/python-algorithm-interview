## 유니코드와 UTF-8
**초기에 문자를 표현하던 대표적인 방식은 ASCII 인코딩 방식**으로, 1바이트에 모든 문자를 표현했다. 이 중 1비트는 체크섬이었기 때문에 7비트, 즉 128글자로 문자를 표현하였다. 그러다 보니 **한글이나 한자 같은 문자**는 특수 문자와 합쳐 표현하게 되었고, 경우에 따라서는 **깨지거나 제대로 표현되지 않았다.**<br> 이에 **2~4 바이트**의 공간에 여유 있게 문자를 할당하는 **유니코드**가 등장하였다. 하지만 1바이트로 표현이 가능한 영문자도 2바이트 이상의 공간을 사용하기 때문에 메모리 낭비가 심하였다. 이에 **가변 길이 문자 인코딩 방식인 UTF-8이 등장**하였다.<br>파이썬 2 이전에는 콘솔에서 한글을 비롯한 특수 문자가 제대로 출력되지 않는 경우가 있었다. 파이썬 3부터는 문자열은 모두 유니코드 기반으로 전환됐고, 영어뿐만 아니라 다국어를 출력하는 데 아무런 불편함이 없다.

UTF-8의 내부 구조를 좀 더 상세히 보자. 만약 모든 문자를 4바이트로 표현한다면 `python`이라는 영문 문자열은 24바이트의 메모리를 차지하게 될 것이다. 영문자는 ASCII 코드로도 충분히 표현이 가능하기 때문에 각 문자당 1바이트로 충분한데, 모든 문자가 4바이트를 차지하기 때문에 3바이트씩 빈 공간이 낭비되고 있다. 이런 문제를 해결하기 위해 UTF-8이 등장하게 된 것이다.
<br>다음 표를 보자.

| 바이트 수 | 바이트 1 | 바이트 2 | 바이트 3 | 바이트 4 |표현 가능한 비트|
|---|---|---|---|---|---|
| 1 | `0xxxxxxx` |   |   |   |0 ~ 7 비트|
| 2 | `110xxxxx` | `10xxxxxx` |   |   |8 ~ 11 비트|
| 3 | `1110xxxx` | `10xxxxxx` | `10xxxxxx` |   |12 ~ 16 비트|
| 4 | `11110xxx` | `10xxxxxx` | `10xxxxxx` | `10xxxxxx` |17 ~ 21 비트|

해당 표와 같이 시작 비트를 살펴보면 문자의 전체 바이트를 결정할 수 있다. 해당 표의 이진 포맷은 다음과 같다.

1. 첫 바이트의 맨 앞 비트가 `0`일 경우 1바이트 문자.
2. 첫 바이트의 맨 앞 비트가 `10`일 경우 특정 문자의 중간 바이트 문자.
3. 첫 바이트의 맨 앞 비트가 `110`일 경우 2바이트 문자.
4. 첫 바이트의 맨 앞 비트가 `1110`일 경우 3바이트 문자.
5. 첫 바이트의 맨 앞 비트가 `11110`일 경우 4바이트 문자.

중요한 점은 **유니코드 값에 따라 가변적으로 바이트를 결정하여 불필요한 공간 낭비를 절약**할 수 있다는 점이다. 값이 127 이하라면 1바이트로 표현한다. 이는 ASCII 문자의 유니코드 값과 동일하므로, 기존 ASCII 문자는 모두 그대로 1바이트에 표현 가능하다.<br>앞서 `python`이라는 문자열도 모두 ASCII 문자 범위 내에 있으므로 24바이트가 아닌 6바이트로 표현 가능하다.

실제로 'A', 'π', '한' 같은 각 문자의 유니코드 값을 UTF-8 인코딩 값으로 표현해보자.

|문자| 유니코드                |UTF-8|
|---|---------------------|---|
|A| `01000001`          |`01000001`|
|π| `00000011 11000000` |`11001111 10000000`|
|한| `11010101 01011100` |`11101101 10010101 10011100`|

1. 'A'는 ASCII 문자이며 7비트 이내에 표현할 수 있다. UTF-8 인코딩 값은 맨 앞 비트를 `0`으로 두고 1바이트로 표현할 수 있다.
2. 'π'는 유니코드 값이 11비트 이내에 표현할 수 있다. UTF-8 인코딩 값은 맨 앞 비트를 `110`으로 두고 2바이트로 표현할 수 있다.
3. '한'은 한글 문자로 유니코드 값이 16비트 이내에 표현할 수 있다. UTF-8 인코딩 값은 맨 앞 비트를 `1110`으로 두고 3바이트로 표현할 수 있다.

> #### 유니코드 인코딩
> 사실 파이썬은 내부적으로 UTF-8 인코딩을 사용하지 않는다. 그 이유는 인덱스를 통해 개별 문자에 접근하기가 어렵기 때문이다. 만약 문자열을 UTF-8으로 인코딩해둔다면 각 문자마다 바이트 길이가 달라지게 되므로, 원하는 인덱스에 빠르게 접근할 수 없다. 따라서 고정 길이 인코딩 방식을 적용한다.<br>모든 문자열이 ASCII 범위 내에 있다면 Latin-1 인코딩 (고정 1바이트 인코딩), 이외의 대부분 문자열은 UCS-2 (고정 2바이트 인코딩), 특수 기호나 그림 이모티콘과 같은 문자열은 UCS-4 (고정 4바이트 인코딩)을 한다.<br>각 문자열에 포함된 문자 범위에 따라 서로 다른 고정 인코디 방식을 택함으로써, 원하는 인덱스에 빠르게 접근할 수 있게 하는 방식을 택하였다.